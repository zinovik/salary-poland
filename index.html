<!DOCTYPE html>
<html>
	<head>
		<title>ðŸ’¸ Salary Poland ðŸ‡µðŸ‡±</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
		<script>
			const INITIAL_GROSS = 0;
			const INITIAL_TOTAL_WORKING_DAYS = 20;
			const INITIAL_WORKED_DAYS = 20;
			const INITIAL_PAID_VACATION_DAYS = 0;
			const INITIAL_LUX_MED = 56.80;
			const INITIAL_MY_BENEFIT = 100;
			const INITIAL_TAX_DEDUCTIBLE_COSTS = 250;
			const INITIAL_TAX_RELIEF = 300;
			const INITIAL_EXCHANGE_RATE = 4.35;

			const PENSION = 0.0976;
			const DISABILITY = 0.015;
			const SICKNESS = 0.0245;
			const HEALTHCARE = 0.09;
			const TAX_LOW = 0.12;
			const TAX_HIGH = 0.32;

			const round = (value) => Math.round(value * 100) * 0.01;
			const getSumAndFormat = (months, name) => round(months.reduce((sum, month) => sum + month[name], 0)).toFixed(2);
			const getAverageAndFormat = (months, name) => round(months.reduce((sum, month) => sum + month[name], 0) / months.length).toFixed(2);
			const setAll = (months, name, value) => months.forEach((month) => month[name] = Number(value));

			const recalculate = (months, options) => {
				options.pensionSum = 0;
				options.taxLowBasisSum = 0;

				months.forEach((_, i) => {
					months[i].working = round(months[i].gross * ( months[i].workedDays / months[i].totalWorkingDays )) || 0;
					months[i].paidVacations = round(months[i].gross * ( months[i].paidVacationDays / months[i].totalWorkingDays )) || 0;
					months[i].totalIncome = round(months[i].working + months[i].paidVacations + Number(months[i].luxMed) + Number(months[i].myBenefit));

					months[i].pension = round(Math.min(months[i].totalIncome * PENSION, options.maxPensionYear - options.pensionSum));
					options.pensionSum = options.pensionSum + months[i].pension;

					months[i].disability = round(months[i].totalIncome * DISABILITY);
					months[i].sickness = round(months[i].totalIncome * SICKNESS);
					months[i].totalZusU = round(months[i].pension + months[i].disability + months[i].sickness);
					months[i].healthcareBasis = round(months[i].totalIncome - months[i].totalZusU);
					months[i].healthcare = round(months[i].healthcareBasis * HEALTHCARE);

					months[i].taxLowBasis = round(Math.min(months[i].totalIncome - months[i].totalZusU - Number(months[i].taxDeductibleCosts), options.maxTaxLowYear - options.taxLowBasisSum));
					options.taxLowBasisSum = options.taxLowBasisSum + months[i].taxLowBasis;

					months[i].taxHighBasis = round(Math.max(0, months[i].totalIncome - months[i].totalZusU - Number(months[i].taxDeductibleCosts) - months[i].taxLowBasis));

					months[i].taxLow = round(months[i].taxLowBasis * TAX_LOW);
					months[i].taxHigh = round(months[i].taxHighBasis * TAX_HIGH);
					months[i].totalTax = Math.floor(Math.max(0, months[i].taxLow + months[i].taxHigh - Number(months[i].taxRelief)));
					months[i].totalOutcome = round(months[i].totalZusU + months[i].healthcare + months[i].totalTax);
					months[i].net = round(months[i].totalIncome - months[i].totalOutcome - Number(months[i].luxMed) - Number(months[i].myBenefit));
					months[i].netUsd = round(months[i].net / Number(months[i].exchangeRate)) || 0;
					months[i].outcomePercentage = round(months[i].totalOutcome / months[i].totalIncome * 100) || 0;
				});
			};
		</script>
		<style type="text/css">
			body {
				font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
			}
			table, th, td {
				border-collapse: collapse;
				border: 1px black solid;
				text-align: center;
			}
			input {
				width: 100;
			}
			.income {
				background-color: lightgreen;
			}
			.outcome {
				background-color: lightcoral;
			}
			.zus {
				background-color: lightyellow;
			}
			.tax {
				background-color: lightpink;
			}
			.net {
				background-color: lightblue;
			}
			.usd {
				font-weight: bolder;
			}
		</style>
	</head>

	<body>
		<div x-data="{
				months: [
					{ name: 'January' },
					{ name: 'February' },
					{ name: 'March' },
					{ name: 'April' },
					{ name: 'May' },
					{ name: 'June' },
					{ name: 'July' },
					{ name: 'August' },
					{ name: 'September' },
					{ name: 'October' },
					{ name: 'November' },
					{ name: 'December' },
				],
				options: {
					maxPensionYear: 20305.68, // 17339.62,
					maxTaxLowYear: 120000,
				},
			}"
			x-init="
				$watch('options.eachGross', (value) => setAll(months, 'gross', value));
				$watch('options.eachTotalWorkingDays', (value) => setAll(months, 'totalWorkingDays', value));
				$watch('options.eachWorkedDays', (value) => setAll(months, 'workedDays', value));
				$watch('options.eachPaidVacationDays', (value) => setAll(months, 'paidVacationDays', value));
				$watch('options.eachLuxMed', (value) => setAll(months, 'luxMed', value));
				$watch('options.eachMyBenefit', (value) => setAll(months, 'myBenefit', value));
				$watch('options.eachTaxDeductibleCosts', (value) => setAll(months, 'taxDeductibleCosts', value));
				$watch('options.eachTaxRelief', (value) => setAll(months, 'taxRelief', value));
				$watch('options.eachExchangeRate', (value) => setAll(months, 'exchangeRate', value));

				options.eachGross = prompt('Enter your GROSS salary', INITIAL_GROSS);
				options.eachTotalWorkingDays = INITIAL_TOTAL_WORKING_DAYS;
				options.eachWorkedDays = INITIAL_WORKED_DAYS;
				options.eachPaidVacationDays = INITIAL_PAID_VACATION_DAYS;
				options.eachLuxMed = INITIAL_LUX_MED;
				options.eachMyBenefit = INITIAL_MY_BENEFIT;
				options.eachTaxDeductibleCosts = INITIAL_TAX_DEDUCTIBLE_COSTS;
				options.eachTaxRelief = INITIAL_TAX_RELIEF;
				options.eachExchangeRate = INITIAL_EXCHANGE_RATE;

				recalculate(months, options);
				$watch('months', () => recalculate(months, options));
			"
		>
			<table>
				<tr>
					<th rowspan="3">Month</th>
					<th rowspan="3">GROSS</th>
					<th colspan="3">Days</th>
					<th colspan="5" class="income">INCOME</th>
					<th colspan="14" class="outcome">OUTCOME</th>
					<th rowspan="3" class="net">NET</th>
					<th rowspan="3">Exchange Rate</th>
					<th rowspan="3">NET, USD</th>
					<th rowspan="3">Outcomes Percentage</th>
				</tr>
				<tr>
					<th rowspan="2">Total working days</th>
					<th rowspan="2">Worked days</th>
					<th rowspan="2">Paid vacation days</th>
					<th colspan="2">Salary</th>
					<th colspan="2">Benefits</th>
					<th rowspan="2" class="income">TOTAL INCOME</th>
					<th colspan="4" class="zus">Social Security ZUS (ubezpieczenie)</th>
					<th colspan="2" class="zus">Healthcare</th>
					<th colspan="7" class="tax">TAX</th>
					<th rowspan="2" class="outcome">TOTAL OUTCOME</th>
				</tr>
				<tr>
					<th alt="test">Working</th>
					<th>Paid Vacation</th>
					<th>Lux Med</th>
					<th>My Benefit</th>
					<th x-text="'Pension ' + PENSION * 100 + '%'"></th>
					<th x-text="'Disability ' + DISABILITY * 100 + '%'"></th>
					<th x-text="'Sickness ' + SICKNESS * 100 + '%'"></th>
					<th class="zus">TOTAL ZUS U</th>
					<th>Basis for Healthcare</th>
					<th class="zus" x-text="'Healthcare ' + HEALTHCARE * 100 + '%'"></th>
					<th>Tax Deductible Costs</th>
					<th>Tax Relief</th>
					<th x-text="'Basis for TAX (' + TAX_LOW * 100 + '%)'"></th>
					<th x-text="'Basis for TAX (' + TAX_HIGH * 100 + '%)'"></th>
					<th x-text="'TAX ' + TAX_LOW * 100 + '%'"></th>
					<th x-text="'TAX ' + TAX_HIGH * 100 + '%'"></th>
					<th class="tax">TOTAL TAX</th>
				</tr>

				<template x-for="(month, i) in months">
					<tr>
						<td><span x-text="month.name" /></td>
						<td><input type="number" size="6" x-model="months[i].gross" /></td>
						<td><input type="number" size="3" x-model="months[i].totalWorkingDays" /></td>
						<td><input type="number" size="3" x-model="months[i].workedDays" /></td>
						<td><input type="number" size="3" x-model="months[i].paidVacationDays" /></td>
						<td><span x-text="months[i].working.toFixed(2)" /></td>
						<td><span x-text="months[i].paidVacations.toFixed(2)" /></td>
						<td><input type="number" size="5" x-model="months[i].luxMed" /></td>
						<td><input type="number" size="4" x-model="months[i].myBenefit" /></td>
						<td class="income"><span x-text="months[i].totalIncome.toFixed(2)" /></td>
						<td><span x-text="months[i].pension.toFixed(2)" /></td>
						<td><span x-text="months[i].disability.toFixed(2)" /></td>
						<td><span x-text="months[i].sickness.toFixed(2)" /></td>
						<td class="zus"><span x-text="months[i].totalZusU.toFixed(2)" /></td>
						<td><span x-text="months[i].healthcareBasis.toFixed(2)" /></td>
						<td class="zus"><span x-text="months[i].healthcare.toFixed(2)" /></td>
						<td><input type="number" size="6" x-model="months[i].taxDeductibleCosts" /></td>
						<td><input type="number" size="4" x-model="months[i].taxRelief" /></td>
						<td><span x-text="months[i].taxLowBasis.toFixed(2)" /></td>
						<td><span x-text="months[i].taxHighBasis.toFixed(2)" /></td>
						<td><span x-text="months[i].taxLow.toFixed(2)" /></td>
						<td><span x-text="months[i].taxHigh.toFixed(2)" /></td>
						<td class="tax"><span x-text="months[i].totalTax" /></td>
						<td class="outcome"><span x-text="months[i].totalOutcome.toFixed(2)" /></td>
						<td class="net"><span x-text="months[i].net.toFixed(2)" /></td>
						<td><input type="number" size="4" x-model="months[i].exchangeRate" /></td>
						<td class="usd"><span x-text="'$' + months[i].netUsd.toFixed(2)" /></td>
						<td><span x-text="months[i].outcomePercentage.toFixed(2) + '%'" /></td>
					</tr>
				</template>

				<tr>
					<td></td>
					<td>Set each: <input type="number" size="6" x-model="options.eachGross" /></td>
					<td>Set each: <input type="number" size="3" x-model="options.eachTotalWorkingDays" /></td>
					<td>Set each: <input type="number" size="3" x-model="options.eachWorkedDays" /></td>
					<td>Set each: <input type="number" size="3" x-model="options.eachPaidVacationDays" /></td>
					<td>Total (year): <span x-text="getSumAndFormat(months, 'working')" /></td>
					<td>Total (year): <span x-text="getSumAndFormat(months, 'paidVacations')" /></td>
					<td>Set each: <input type="number" size="5" x-model="options.eachLuxMed" /></td>
					<td>Set each: <input type="number" size="4" x-model="options.eachMyBenefit" /></td>
					<td class="income">Total (year): <span x-text="getSumAndFormat(months, 'totalIncome')" /></td>
					<td>Max (year): <input type="number" size="8" x-model="options.maxPensionYear" /></td>
					<td>Total (year): <span x-text="getSumAndFormat(months, 'disability')" /></td>
					<td>Total (year): <span x-text="getSumAndFormat(months, 'sickness')" /></td>
					<td class="zus">Total (year): <span x-text="getSumAndFormat(months, 'totalZusU')" /></td>
					<td>Total (year): <span x-text="getSumAndFormat(months, 'healthcareBasis')" /></td>
					<td class="zus">Total (year): <span x-text="getSumAndFormat(months, 'healthcare')" /></td>
					<td>Set each: <input type="number" size="6" x-model="options.eachTaxDeductibleCosts" /></td>
					<td>Set each: <input type="number" size="4" x-model="options.eachTaxRelief" /></td>
					<td>Max (year): <input type="number" size="7" x-model="options.maxTaxLowYear" /></td>
					<td>Total (year): <span x-text="getSumAndFormat(months, 'taxHighBasis')" /></td>
					<td>Total (year): <span x-text="getSumAndFormat(months, 'taxLow')" /></td>
					<td>Total (year): <span x-text="getSumAndFormat(months, 'taxHigh')" /></td>
					<td class="tax">Total (year): <span x-text="getSumAndFormat(months, 'totalTax')" /></td>
					<td class="outcome">Total (year): <span x-text="getSumAndFormat(months, 'totalOutcome')" /></td>
					<td class="net"><span x-text="getAverageAndFormat(months, 'net') + ' * 12 = ' + getSumAndFormat(months, 'net')" /></td>
					<td>Set each: <input type="number" size="4" x-model="options.eachExchangeRate" /></td>
					<td class="usd"><span x-text="'$' +getAverageAndFormat(months, 'netUsd') + ' * 12 = $' + getSumAndFormat(months, 'netUsd')" /></td>
					<td>Total (month): <span x-text="getAverageAndFormat(months, 'outcomePercentage') + '%'" /></td>
				</tr>
			</table>
		</div>

	</body>
</html>
