<!DOCTYPE html>
<html>
	<head>
		<title>ðŸ’¸ Salary Poland ðŸ‡µðŸ‡±</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
		<script>
			const INITIAL_GROSS = 17000;
			const INITIAL_TOTAL_WORKING_DAYS = 20;
			const INITIAL_WORKED_DAYS = 20;
			const INITIAL_PAID_VACATION_DAYS = 0;
			const INITIAL_LUX_MED = 56.80;
			const INITIAL_MY_BENEFIT = 100;
			const INITIAL_TAX_DEDUCTIBLE_COSTS = 250;
			const INITIAL_TAX_RELIEF = 300;
			const INITIAL_EXCHANGE_RATE = 4.35;

			const PENSION = 0.0976;
			const MAX_PENSION_YEAR = 17339.62;
			const DISABILITY = 0.015;
			const SICKNESS = 0.0245;
			const HEALTHCARE = 0.09;
			const TAX_LOW = 0.12;
			const MAX_TAX_LOW_YEAR = 120000;
			const TAX_HIGH = 0.32;

			const round = (value) => Math.round(value * 100) / 100;
			const getSumBefore = (months, func, currentIndex) => months.reduce((sum, month, index) => index < currentIndex ? sum + func(months, index) : sum, 0);
			const getSum = (months, func) => months.reduce((sum, value, i) => sum + func(months, i), 0);
			const getAverage = (months, func) => getSum(months, func) / months.length;
			const setAll = (months, name, value) => months.forEach((month) => month[name] = Number(value));

			const getWorking = (months, i) => round(months[i].gross * ( months[i].workedDays / months[i].totalWorkingDays ));
			const getPaidVacations = (months, i) => round(months[i].gross * ( months[i].paidVacationDays / months[i].totalWorkingDays ));
			const getTotalIncome = (months, i) => round(getWorking(months, i) + getPaidVacations(months, i) + Number(months[i].luxMed) + Number(months[i].myBenefit));

			const getPensionMonth = (months, i) => round(getTotalIncome(months, i) * PENSION);
			const getPension = (months, i) => round(Math.max(0, Math.min(getPensionMonth(months, i), MAX_PENSION_YEAR - getSumBefore(months, getPensionMonth, i))));

			const getDisability = (months, i) => round(getTotalIncome(months, i) * DISABILITY);
			const getSickness = (months, i) => round(getTotalIncome(months, i) * SICKNESS);
			const getTotalZusU = (months, i) => round(getPension(months, i) + getDisability(months, i) + getSickness(months, i));
			const getHealthcareBasis = (months, i) => round(getTotalIncome(months, i) - getTotalZusU(months, i));
			const getHealthcare = (months, i) => round(getHealthcareBasis(months, i) * HEALTHCARE);

			const getTaxLowBasisMonth = (months, i) => round(getTotalIncome(months, i) - getTotalZusU(months, i) - Number(months[i].taxDeductibleCosts));
			const getTaxLowBasis = (months, i) => round(Math.max(0, Math.min(getTaxLowBasisMonth(months, i), MAX_TAX_LOW_YEAR - getSumBefore(months, getTaxLowBasisMonth, i))));
			const getTaxHighBasis = (months, i) => round(Math.max(0, getTotalIncome(months, i) - getTotalZusU(months, i) - Number(months[i].taxDeductibleCosts) - getTaxLowBasis(months, i)));

			const getTaxLow = (months, i) => round(getTaxLowBasis(months, i) * TAX_LOW);
			const getTaxHigh = (months, i) => round(getTaxHighBasis(months, i) * TAX_HIGH);
			const getTotalTax = (months, i) => Math.floor(Math.max(0, getTaxLow(months, i) + getTaxHigh(months, i) - Number(months[i].taxRelief)));
			const getTotalOutcome = (months, i) => round(getTotalZusU(months, i) + getHealthcare(months, i) + getTotalTax(months, i));
			const getNet = (months, i) => round(getTotalIncome(months, i) - getTotalOutcome(months, i) - Number(months[i].luxMed) - Number(months[i].myBenefit));
			const getNetUsd = (months, i) => round(getNet(months, i) / Number(months[i].exchangeRate));
			const getOutcomePercentage = (months, i) => round(getTotalOutcome(months, i) / getTotalIncome(months, i) * 100) || 0;
		</script>
		<style type="text/css">
			body {
				font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
			}
			table, th, td {
				border-collapse: collapse;
				border: 1px black solid;
				text-align: center;
			}
			input {
				width: 100;
			}
			.income {
				background-color: lightgreen;
			}
			.outcome {
				background-color: lightcoral;
			}
			.zus {
				background-color: lightyellow;
			}
			.tax {
				background-color: lightpink;
			}
			.net {
				background-color: lightblue;
			}
			.usd {
				font-weight: bolder;
			}
		</style>
	</head>

	<body>
		<div x-data="{
				months: [
					{ name: 'January' },
					{ name: 'February' },
					{ name: 'March' },
					{ name: 'April' },
					{ name: 'May' },
					{ name: 'June' },
					{ name: 'July' },
					{ name: 'August' },
					{ name: 'September' },
					{ name: 'October' },
					{ name: 'November' },
					{ name: 'December' },
				],
			}"
			x-init="months.forEach((_, i) => {
				months[i].gross = INITIAL_GROSS;
				months[i].totalWorkingDays = INITIAL_TOTAL_WORKING_DAYS;
				months[i].workedDays = INITIAL_WORKED_DAYS;
				months[i].paidVacationDays = INITIAL_PAID_VACATION_DAYS;
				months[i].luxMed = INITIAL_LUX_MED;
				months[i].myBenefit = INITIAL_MY_BENEFIT;
				months[i].taxDeductibleCosts = INITIAL_TAX_DEDUCTIBLE_COSTS;
				months[i].taxRelief = INITIAL_TAX_RELIEF;
				months[i].exchangeRate = INITIAL_EXCHANGE_RATE;
			})"
		>
			<table>
				<tr>
					<th rowspan="3">Month</th>
					<th rowspan="3">GROSS</th>
					<th colspan="3">Days</th>
					<th colspan="5" class="income">INCOME</th>
					<th colspan="14" class="outcome">OUTCOME</th>
					<th rowspan="3" class="net">NET</th>
					<th rowspan="3">Exchange Rate</th>
					<th rowspan="3">NET, USD</th>
					<th rowspan="3">Outcomes Percentage</th>
				</tr>
				<tr>
					<th rowspan="2">Total working days</th>
					<th rowspan="2">Worked days</th>
					<th rowspan="2">Paid vacation days</th>
					<th colspan="2">Salary</th>
					<th colspan="2">Benefits</th>
					<th rowspan="2" class="income">TOTAL INCOME</th>
					<th colspan="4" class="zus">Social Security ZUS (ubezpieczenie)</th>
					<th colspan="2" class="zus">Healthcare</th>
					<th colspan="7" class="tax">TAX</th>
					<th rowspan="2" class="outcome">TOTAL OUTCOME</th>
				</tr>
				<tr>
					<th alt="test">Working</th>
					<th>Paid Vacation</th>
					<th>Lux Med</th>
					<th>My Benefit</th>
					<th x-text="'Pension ' + PENSION * 100 + '%'"></th>
					<th x-text="'Disability ' + DISABILITY * 100 + '%'"></th>
					<th x-text="'Sickness ' + SICKNESS * 100 + '%'"></th>
					<th class="zus">TOTAL ZUS U</th>
					<th>Basis for Healthcare</th>
					<th class="zus" x-text="'Healthcare ' + HEALTHCARE * 100 + '%'"></th>
					<th>Tax Deductible Costs</th>
					<th>Tax Relief</th>
					<th x-text="'Basis for TAX (' + TAX_LOW * 100 + '%)'"></th>
					<th x-text="'Basis for TAX (' + TAX_HIGH * 100 + '%)'"></th>
					<th x-text="'TAX ' + TAX_LOW * 100 + '%'"></th>
					<th x-text="'TAX ' + TAX_HIGH * 100 + '%'"></th>
					<th class="tax">TOTAL TAX</th>
				</tr>

				<template x-for="(month, i) in months">
					<tr>
						<td><span x-text="month.name" /></td>
						<td><input type="number" size="6" x-model="months[i].gross" /></td>
						<td><input type="number" size="3" x-model="months[i].totalWorkingDays" /></td>
						<td><input type="number" size="3" x-model="months[i].workedDays" /></td>
						<td><input type="number" size="3" x-model="months[i].paidVacationDays" /></td>
						<td><span x-text="getWorking(months, i).toFixed(2)" /></td>
						<td><span x-text="getPaidVacations(months, i).toFixed(2)" /></td>
						<td><input type="number" size="6" x-model="months[i].luxMed" /></td>
						<td><input type="number" size="6" x-model="months[i].myBenefit" /></td>
						<td class="income"><span x-text="getTotalIncome(months, i).toFixed(2)" /></td>
						<td><span x-text="getPension(months, i).toFixed(2)" /></td>
						<td><span x-text="getDisability(months, i).toFixed(2)" /></td>
						<td><span x-text="getSickness(months, i).toFixed(2)" /></td>
						<td class="zus"><span x-text="getTotalZusU(months, i).toFixed(2)" /></td>
						<td><span x-text="getHealthcareBasis(months, i).toFixed(2)" /></td>
						<td class="zus"><span x-text="getHealthcare(months, i).toFixed(2)" /></td>
						<td><input type="number" size="6" x-model="months[i].taxDeductibleCosts" /></td>
						<td><input type="number" size="6" x-model="months[i].taxRelief" /></td>
						<td><span x-text="getTaxLowBasis(months, i).toFixed(2)" /></td>
						<td><span x-text="getTaxHighBasis(months, i).toFixed(2)" /></td>
						<td><span x-text="getTaxLow(months, i).toFixed(2)" /></td>
						<td><span x-text="getTaxHigh(months, i).toFixed(2)" /></td>
						<td class="tax"><span x-text="getTotalTax(months, i)" /></td>
						<td class="outcome"><span x-text="getTotalOutcome(months, i).toFixed(2)" /></td>
						<td class="net"><span x-text="getNet(months, i).toFixed(2)" /></td>
						<td><input type="number" size="6" x-model="months[i].exchangeRate" /></td>
						<td class="usd"><span x-text="'$' + getNetUsd(months, i).toFixed(2)" /></td>
						<td><span x-text="getOutcomePercentage(months, i).toFixed(2) + '%'" /></td>
					</tr>
				</template>

				<tr>
					<td>TOTAL</td>
					<td><input type="number" size="6" @change="setAll(months, 'gross', $event.target.value)" /></td>
					<td><input type="number" size="3" @change="setAll(months, 'totalWorkingDays', $event.target.value)" /></td>
					<td><input type="number" size="3" @change="setAll(months, 'workedDays', $event.target.value)" /></td>
					<td><input type="number" size="3" @change="setAll(months, 'paidVacationDays', $event.target.value)" /></td>
					<td><span x-text="round(getSum(months, getWorking)).toFixed(2)" /></td>
					<td><span x-text="round(getSum(months, getPaidVacations)).toFixed(2)" /></td>
					<td><input type="number" size="6" @change="setAll(months, 'luxMed', $event.target.value)" /></td>
					<td><input type="number" size="6" @change="setAll(months, 'myBenefit', $event.target.value)" /></td>
					<td class="income"><span x-text="round(getSum(months, getTotalIncome)).toFixed(2)" /></td>
					<td><span x-text="round(getSum(months, getPension)).toFixed(2)" /></td>
					<td><span x-text="round(getSum(months, getDisability)).toFixed(2)" /></td>
					<td><span x-text="round(getSum(months, getSickness)).toFixed(2)" /></td>
					<td class="zus"><span x-text="round(getSum(months, getTotalZusU))" /></td>
					<td><span x-text="round(getSum(months, getHealthcareBasis).toFixed(2))" /></td>
					<td class="zus"><span x-text="round(getSum(months, getHealthcare))" /></td>
					<td><input type="number" size="6" @change="setAll(months, 'taxDeductibleCosts', $event.target.value)" /></td>
					<td><input type="number" size="6" @change="setAll(months, 'taxRelief', $event.target.value)" /></td>
					<td><span x-text="round(getSum(months, getTaxLowBasis)).toFixed(2)" /></td>
					<td><span x-text="round(getSum(months, getTaxHighBasis)).toFixed(2)" /></td>
					<td><span x-text="round(getSum(months, getTaxLow)).toFixed(2)" /></td>
					<td><span x-text="round(getSum(months, getTaxHigh)).toFixed(2)" /></td>
					<td class="tax"><span x-text="round(getSum(months, getTotalTax))" /></td>
					<td class="outcome"><span x-text="round(getSum(months, getTotalOutcome)).toFixed(2)" /></td>
					<td class="net"><span x-text="round(getAverage(months, getNet)).toFixed(2) + ' * 12 = ' + round(getSum(months, getNet)).toFixed(2)" /></td>
					<td><input type="number" size="6" @change="setAll(months, 'exchangeRate', $event.target.value)" /></td>
					<td class="usd"><span x-text="'$' +round(getAverage(months, getNetUsd)).toFixed(2) + ' * 12 = $' + round(getSum(months, getNetUsd)).toFixed(2)" /></td>
					<td><span x-text="round(getAverage(months, getOutcomePercentage)).toFixed(2) + '%'" /></td>
				</tr>
			</table>
		</div>

	</body>
</html>
